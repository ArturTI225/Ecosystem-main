{% extends 'accounts/base.html' %}
{% load static %}

{% block title %}Profilul meu - UNITEX{% endblock %}

{% block body_class %}auth-body profile-body{% endblock %}

{% block auth_content %}
<section class="profile-shell">
    <aside class="profile-card" data-animate>
        <div class="profile-card__avatar">
            {% if user_profile.avatar %}
                <img src="{{ user_profile.avatar.url }}" alt="Avatar utilizator">
            {% else %}
                <img src="https://api.dicebear.com/7.x/bottts/svg?background=%23dbeafe&radius=50&seed={{ user_profile.user.username|default:user.username|urlencode }}" alt="Avatar generat pentru {{ user_profile.name|default:user.username }}">
            {% endif %}
            <span class="profile-card__sticker profile-card__sticker--rocket" aria-hidden="true">‚ú®</span>
            <span class="profile-card__sticker profile-card__sticker--sparkle" aria-hidden="true">üß†</span>
        </div>
        <h1 class="profile-card__title">Salut, {{ user_profile.name|default:user.username }}!</h1>
        <p class="profile-card__subtitle">{{ user_profile.bio|default:'Completeaza-ti profilul si porneste in urmatoarea misiune digitala.' }}</p>
        <div class="profile-card__stats">
            <span>
                <strong>{{ global_progress.completed|default:0 }}</strong>
                <small>lectii finalizate</small>
            </span>
            <span>
                <strong>{{ global_progress.streak|default:0 }}</strong>
                <small>zile consecutiv</small>
            </span>
            <span>
                <strong>{{ badge_summary.badges|default:0 }}</strong>
                <small>insigne stralucitoare</small>
            </span>
        </div>
        <a class="btn btn--primary profile-card__action" href="{% url 'edit_profile' %}">
            <i class="fa-solid fa-pen-to-square"></i> Editeaza profilul
        </a>
    </aside>

        <div class="profile-details" data-animate>
            <div class="profile-details__header">
                <div class="profile-details__title">
                    <span class="profile-badge" aria-hidden="true">üõ†Ô∏è</span>
                    <div>
                    <h2>Card de explorator</h2>
                    <p>Informatii rapide despre contul tau UNITEX</p>
                </div>
            </div>
            <a class="link-ghost" href="{% url 'index' %}"><i class="fa-solid fa-home"></i> Inapoi la pagina principala</a>
        </div>

        <dl class="profile-list">
            <div class="profile-list__item">
                <dt>Porecla</dt>
                <dd>{{ user_profile.user.username }}</dd>
            </div>
            <div class="profile-list__item">
                <dt>Adresa de email</dt>
                <dd>
                    {% if user_profile.email %}
                        <a href="mailto:{{ user_profile.email }}">{{ user_profile.email }}</a>
                    {% else %}
                        <span class="text-muted">Nu este completata inca</span>
                    {% endif %}
                </dd>
            </div>
            <div class="profile-list__item">
                <dt>Telefon</dt>
                <dd>{{ user_profile.phone_number|default:'Adauga un numar pentru notificari rapide' }}</dd>
            </div>
            <div class="profile-list__item">
                <dt>Membru din</dt>
                <dd>{{ user_profile.user.date_joined|date:"d F Y" }}</dd>
            </div>
            <div class="profile-list__item">
                <dt>Rol activ</dt>
                <dd>{{ user_profile.role|default:'Explorator' }}</dd>
            </div>
        </dl>

        <section class="profile-awards">
            <header>
                <h3>Trofee digitale</h3>
                <p>Pastreaza ritmul pentru a colectiona promovari si stickere noi.</p>
            </header>
            <div class="profile-awards__grid">
                {% if highlighted_badges %}
                    {% for badge in highlighted_badges %}
                        <article class="award-card">
                            <span class="award-card__icon" style="--badge-color: {{ badge.badge.color }};">
                                <i class="fa {{ badge.badge.icon }}"></i>
                            </span>
                            <div>
                                <h4>{{ badge.badge.name }}</h4>
                                <p>Obtinuta in {{ badge.acquired_at|date:"F Y" }}</p>
                            </div>
                        </article>
                    {% endfor %}
                {% else %}
                    <article class="award-card award-card--empty">
                        <h4>Niciun trofeu inca</h4>
                        <p>Finalizeaza lectii si misiuni pentru a umple raftul cu trofee.</p>
                    </article>
                {% endif %}
            </div>
        </section>
    </div>
</section>
{% endblock %}
